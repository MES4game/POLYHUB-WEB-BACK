services:
  back:
    image: ${BACK_DOCKER_IMAGE}
    container_name: ${BACK_DOCKER_CONTAINER}
    restart: unless-stopped
    environment:
      - HOST=${BACK_ENV_HOST}
      - MAIL_HOST=${BACK_ENV_MAIL_HOST}
      - MAIL_PORT=${BACK_ENV_MAIL_PORT}
      - MAIL_USER=${BACK_ENV_MAIL_USER}
      - MAIL_PASS=${BACK_ENV_MAIL_PASS}
      - DATA_FOLDER=${BACK_ENV_DATA_FOLDER}
      - DB_NAME=${DB_ENV_DB_NAME}
      - DB_USER=${DB_ENV_DB_USER}
      - DB_PASS=${DB_ENV_DB_PASS}
    ports:
      - "127.0.0.1:${BACK_DOCKER_PORT}:3000"
    volumes:
      - ${BACK_DOCKER_MOUNTED}:/mounted
    depends_on:
      - db
    networks:
      - polyhub-web-network

  db:
    image: ${DB_DOCKER_IMAGE}
    container_name: ${DB_DOCKER_CONTAINER}
    restart: unless-stopped
    environment:
      - MYSQL_DATABASE=${DB_ENV_DB_NAME}
      - MYSQL_USER=${DB_ENV_DB_USER}
      - MYSQL_PASSWORD=${DB_ENV_DB_PASS}
      - ADMIN_EMAIL=${DB_ENV_ADMIN_EMAIL}
    volumes:
      - ${DB_DOCKER_MOUNTED}:/var/lib/mysql
    networks:
      - polyhub-web-network

networks:
  polyhub-web-network:
    driver: bridge
